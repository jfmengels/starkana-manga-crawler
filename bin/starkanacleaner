#!/usr/bin/env node

'use strict';

var fs = require("fs");
var async = require("async");
var fileLister = require("file-lister");

var cleaner = require("../cleaner.js");

var fileLister = require("file-lister");

var dirArgs = process.argv.slice(2, process.argv.length);
async.map(dirArgs, fileLister.listFiles, function(error, lists) {
    if (error) {
        return console.error(error);
    }
    var list = lists.reduce(function(a, b) {
        return a.concat(b);
    }, []);

    cleaner.findDuplicatesAndCredits(list, function(error, filesToRemove) {
        if (error) {
            return console.error(error);
        }
        async.each(filesToRemove, fs.unlink, function(error) {
            if (error) {
                console.error(error);
            }
        });
    });
});